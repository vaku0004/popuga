<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Article Game: "the"</title>
  <style>
    :root{
      --bg:#f7f8fb;
      --fg:#101217;
      --tile-border:#b9c2d0;
    }

    html, body{
      margin:0;
      padding:0;
      background:var(--bg);
      color:var(--fg);
      font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      min-height:100%;
    }

    h1 {
      text-align: center;
      margin: 8px 0 0 0;
      font-weight: 700;
    }

    .header-container{
      max-width:1400px;
      margin:16px auto 0;
      padding:0 16px;
      display:flex;
      align-items:center;
      gap:16px;
    }
    .header-image{ height:48px }
    .score-box{ margin-left:auto; display:flex; align-items:center; gap:16px }
    .score-line{ font-weight:700 }
    .hint-button{
      border:1px solid var(--tile-border);
      background:#fff;
      padding:8px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
    }

    #game {
      display: flex;
      justify-content: center;
      width: 100%;
      max-width: 800px;
      height: 500px;
      margin: 20px auto;
      border: 2px solid #333;
      background-color: white;
      position: relative;
      overflow: visible;
      border-radius: 10px;
      background-image: linear-gradient(rgba(29, 80, 189, 0.5), rgba(24, 66, 158, 0.5)), url("img/tug2.png");
      background-size: cover;
      background-position: center;
    }

    #lives {
      margin-top: 10px;
      font-weight: bold;
      text-align: center;
    }

    @media (max-width: 768px) {
      #game {
        background:
          linear-gradient(rgba(29, 80, 189, 0.6), rgba(24, 66, 158, 0.6)),
          url("img/tug _mob.png");
        background-size: cover;
        background-position: bottom;
      }
      .header-container {
        gap: 8px;
        padding: 0 8px;
      }
      .header-image { height: 32px; }
      .score-box { gap: 8px; font-size: 14px; }
      .score-line { font-weight: 600; }
      .hint-button { padding: 4px 8px; font-size: 12px; border-radius: 6px; }
    }

    @media (max-width: 480px) {
      .header-container {
        flex-direction: column;
        align-items: center;
        gap: 4px;
      }
      .score-box {
        justify-content: center;
        width: 100%;
        font-size: 12px;
      }
      .hint-button { font-size: 11px; padding: 3px 6px; }
    }

    .column {
      flex: 1;
      border-left: 1px solid #ccc;
      position: relative;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      align-content: flex-end;
      justify-content: center;
      padding: 70px 5px 60px 5px;
      overflow-y: auto;
      font-size: clamp(10px, 1.2vw, 14px);
    }
    .column:first-child { border-left: none; }

    .label {
      text-align: center;
      font-weight: bold;
      background: #eee;
      padding: 5px;
      border-bottom: 1px solid #ccc;
      position: absolute;
      top: 0;
      width: 100%;
    }

    .drop-btn {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      margin-bottom: 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
      color: white;
      border: none;
      border-radius: 4px;
      width: 90%;
    }
    #withThe .drop-btn {
      background-color: #fa9507;
      box-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
      border: 1px solid #e77722;
    }
    #withoutThe .drop-btn {
      background-color: #21a340;
      box-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
      border: 1px solid #06944b;
    }

    .word {
      position: absolute;
      padding: 5px 10px;
      background-color: #f3fcff;
      border-radius: 5px;
      z-index: 10;
      transition: top 0.3s;
      white-space: nowrap;
      box-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
      border: 1px solid #595959;
    }
    .word.correct, .word-stack.correct {
      background-color: #90ee90;
      box-shadow: 3px 3px 3px rgba(66, 28, 232, 0.3);
    }
    .word.incorrect, .word-stack.incorrect {
      background-color: #f6a573;
      box-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
    }

    .word-stack {
      position: static;
      margin: 3px;
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      white-space: nowrap;
    }

    /* –ö–Ω–æ–ø–∫–∏ –º–æ–¥–∞–ª–∫–∏ */
    .game-button{
      padding:10px 20px;
      font-size:16px;
      cursor:pointer;
      margin-top:10px;
      border-radius:10px;
      border:none;
    }
    .restart-btn { background-color:#ff8707; color:#fff; }
    .restart-btn:hover { background-color:#c26a06; }
    .next-btn { background-color:#28A745; color:#fff; }
    .next-btn:hover { background-color:#1e7e34; }

  </style>
</head>
<body>
  <header class="header-container">
    <a href="index.html">
      <img src="img/header_cards.png" alt="Synonyms Logo" class="header-image">
    </a>
    <div class="score-box">
      <div class="score-line">‚≠ê Score: <span id="currentScore">0/5</span></div>
      <div class="score-line">‚ù§Ô∏è Lives: <span id="livesHeader">3</span></div>
      <button id="hintButton" class="hint-button">Hint (0)</button>
    </div>
  </header>

  <h1>Article Game: "the"</h1>
  <div id="lives">Lives: 3</div>

  <div id="game">
    <div class="column" id="withThe">
      <div class="label">Needs "the"</div>
      <button class="drop-btn" onclick="chooseColumn('withThe')">Drop here</button>
    </div>
    <div class="column" id="withoutThe">
      <div class="label">No article</div>
      <button class="drop-btn" onclick="chooseColumn('withoutThe')">Drop here</button>
    </div>
  </div>

  <footer style="text-align:center; margin:24px 0; font-weight:700;">
    <a href="https://www.popuga.online/articles.html" style="margin:0 16px; text-decoration:none; color:var(--fg);">üìñ Articles</a>
    <a href="https://www.popuga.online/game3.html" style="margin:0 16px; text-decoration:none; color:var(--fg);">üéÆ Verb Tetris</a>
  </footer>

  <script>
    const NEXT_URL = "https://www.popuga.online/synonyms.html"; // –±–µ–∑ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–≥–æ —Å–ª–µ—à–∞

    const columns = ["withThe", "withoutThe"];
    const wordList = [
      ...[
        "sun", "moon", "Earth", "sky",
        "Volga", "Nile", "Pacific Ocean", "Andes", "Sahara", "Philippines", "Arctic",
        "Alps", "United States", "Netherlands",
        "New York Times", "Washington Post", "Wall Street Journal",
        "European Union", "BBC",
        "Louvre", "British Museum", "Globe Theatre",
        "rich", "elderly", "poor",
        "best", "first", "only", "Simpsons",
        "Smiths", "Romanovs",
        "Titanic",
        "University of Toronto", "London School of Economics",
        "Constitution", "Statue of Liberty",
        "Internet", "radio", "climate", "environment",
        "King's Arms pub", "Ritz hotel",
        "piano", "guitar",
        "Cold War", "Great Fire of London"
      ].map(w => ({ word: w, type: "withThe" })),
      ...[
        "Dr. Smith", "Canada", "France", "Japan", "Paris", "Toronto",
        "Oxford University", "York University",
        "Queen Street", "Fifth Avenue",
        "Union Station", "Bay Station",
        "English", "math", "history",
        "Monday", "July", "Christmas",
        "breakfast", "lunch", "dinner",
        "football", "tennis", "chess",
        "Google", "Apple", "Microsoft",
        "love", "life", "freedom", "money", "time",
        "coffee", "water", "bread", "gold",
        "iPhone 14 Pro", "Galaxy S24", "MacBook Air",
        "Lake Ontario", "Mount Everest", "Vancouver Island",
        "Alberta", "Europe", "Tokyo",
        "California", "Texas", "Neptune", "Pearson Airport", "Walmart", "Moscow Oblast", "Niagara Falls"
      ].map(w => ({ word: w, type: "withoutThe" }))
    ];

    let words = [...wordList];
    let lives = 3;
    let currentWord = null;
    let currentWordElement = null;
    let currentColumn = null;

    // –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∂–∏–∑–Ω–µ–π –≤ —à–∞–ø–∫–µ
    document.getElementById("livesHeader").textContent = lives;

    function dropWord() {
      if (lives <= 0 || words.length === 0) return;

      const game = document.getElementById("game");
      const index = Math.floor(Math.random() * words.length);
      const wordData = words.splice(index, 1)[0];
      const randomColIndex = Math.floor(Math.random() * columns.length);
      currentColumn = columns[randomColIndex];

      const wordDiv = document.createElement("div");
      wordDiv.classList.add("word");
      wordDiv.textContent = wordData.word;
      wordDiv.style.left = `${randomColIndex * 50 + 15}%`;
      wordDiv.style.top = `0px`;
      game.appendChild(wordDiv);

      currentWord = wordData;
      currentWordElement = wordDiv;

      let topPos = 0;
      const fall = setInterval(() => {
        if (!currentWordElement) {
          clearInterval(fall);
          return;
        }
        topPos += 2;
        currentWordElement.style.top = `${topPos}px`;

        if (topPos >= 440) {
          clearInterval(fall);
          handleChoice(currentColumn, true);
        }
      }, 30);
    }

    function chooseColumn(colId) {
      if (!currentWord || !currentWordElement) return;
      handleChoice(colId, false);
    }

    function handleChoice(colId, autoFall) {
      const col = document.getElementById(colId);
      const correct = colId === currentWord.type;
      const wasCorrect = correct && !autoFall;

      currentWordElement.classList.add(wasCorrect ? "correct" : "incorrect");

      const stackWord = document.createElement("div");
      stackWord.className = `word-stack ${wasCorrect ? "correct" : "incorrect"}`;
      stackWord.textContent = currentWord.word;
      col.appendChild(stackWord);

      if (!wasCorrect) {
        lives--;
        document.getElementById("lives").textContent = `Lives: ${lives}`;
        document.getElementById("livesHeader").textContent = lives;
        if (lives === 0) {
          currentWordElement.remove();
          currentWord = null;
          currentWordElement = null;
          return showGameOver();
        }
      }

      currentWordElement.remove();
      currentWord = null;
      currentWordElement = null;

      if (lives > 0) {
        if (words.length === 0) {
          setTimeout(showVictoryScreen, 600);
        } else {
          setTimeout(dropWord, 600);
        }
      }
    }

    function showOverlayBox(messageText, buttons = []) {
      const overlay = document.createElement("div");
      overlay.style.position = "fixed";
      overlay.style.top = 0;
      overlay.style.left = 0;
      overlay.style.width = "100vw";
      overlay.style.height = "100vh";
      overlay.style.background = "rgba(0, 0, 0, 0.6)";
      overlay.style.display = "flex";
      overlay.style.flexDirection = "column";
      overlay.style.alignItems = "center";
      overlay.style.justifyContent = "center";
      overlay.style.zIndex = 1000;

      const box = document.createElement("div");
      box.style.background = "white";
      box.style.padding = "30px";
      box.style.borderRadius = "8px";
      box.style.boxShadow = "0 0 10px rgba(0,0,0,0.3)";
      box.style.textAlign = "center";
      overlay.appendChild(box);

      const message = document.createElement("p");
      message.textContent = messageText;
      box.appendChild(message);

      const buttonsWrap = document.createElement("div");
      buttonsWrap.style.display = "flex";
      buttonsWrap.style.gap = "12px";
      buttonsWrap.style.justifyContent = "center";
      buttonsWrap.style.marginTop = "12px";
      box.appendChild(buttonsWrap);

      buttons.forEach(btn => buttonsWrap.appendChild(btn));

      document.body.appendChild(overlay);
      return overlay; // –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –∑–∞—Ö–æ—á–µ—à—å –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
    }

    function showGameOver() {
      const restartBtn = document.createElement("button");
      restartBtn.textContent = "Restart Game";
      restartBtn.className = "game-button restart-btn";
      restartBtn.onclick = () => location.reload();

      const nextBtn = document.createElement("button");
      nextBtn.textContent = "Next activity";
      nextBtn.className = "game-button next-btn";
      nextBtn.onclick = () => window.location.href = NEXT_URL;

      showOverlayBox("üíÄ Game Over! Try again or go to the next activity?", [restartBtn, nextBtn]);
    }

    function showVictoryScreen() {
      const restartBtn = document.createElement("button");
      restartBtn.textContent = "Restart Game";
      restartBtn.className = "game-button restart-btn";
      restartBtn.onclick = () => location.reload();

      const nextBtn = document.createElement("button");
      nextBtn.textContent = "Next activity";
      nextBtn.className = "game-button next-btn";
      nextBtn.onclick = () => window.location.href = NEXT_URL;

      showOverlayBox("üéâ Congratulations, you won! What‚Äôs next?", [restartBtn, nextBtn]);
    }

    // –°—Ç–∞—Ä—Ç—É–µ–º –∏–≥—Ä—É
    dropWord();
  </script>
</body>
</html>